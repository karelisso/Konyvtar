@{
    //Layout = null;
    book_vs19Entities1 bullshit = new book_vs19Entities1();

    konyv[] kv;
    kv = bullshit.konyv.ToArray();
    Reader_Card[] cr = bullshit.Reader_Card.ToArray();
    Reader_Card rc;
    List<Rent> rent = new List<Rent>();
    int puinishment = 0;
    int sessionuid = int.Parse(Session["userid"].ToString());
    if(Session["currentreadercard"] != null) { sessionuid = int.Parse(Session["currentreadercard"].ToString()); }
    rc = bullshit.Reader_Card.Where(q => q.User_ID == sessionuid).FirstOrDefault();
    if (rc != null)
    {
        rent = bullshit.Rent.Where(q => q.Card_ID == rc.User_ID).ToList();
    }
}

<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title></title>
</head>
<body>
    <header>
        <h1 class="float-end text-white">
            Jelenleg: Olvasókártya
        </h1>
    </header>
    <div>

        <p>Tag felvétele</p>
        @*this is for rent_cards*@
        <form action="CreateReader" method="post" class="text-white bg-dark bg-opacity-50">
            <h3 class="opacity-100">Olvasó</h3>
            <table class="w-100">
                <tr>
                    <td> <label>Név</label>  </td>
                    <td> <input type="text" name="name" value="" autocomplete="off" />   </td>
                </tr>
                <tr>
                    <td> <label>Annya neve</label>  </td>
                    <td> <input type="text" name="name2" value="" autocomplete="off" />   </td>

                </tr>

                <tr>
                    <td class="col-3"> <label>Születés hely</label>    </td>
                    <td class="col-9"> <input type="type" name="birthpalace" value="" maxlength="10" required autocomplete="off" /> </td>
                </tr>

                <tr>
                    <td class="col-3"> <label>Születés dátuma</label>    </td>
                    <td class="col-9"> <input type="type" name="birthday" value="" maxlength="10" required autocomplete="off" /> </td>
                </tr>


                <tr>
                    <td class="col-3"><label>Személyi igazolvány szám</label>    </td>
                    <td class="col-9">  <input class="w-100" type="text" name="szid" value="" autocomplete="off" /> </td>
                </tr>
                <tr>
                    <td>  <label>lakcím</label>  </td>
                    <td>  <input type="text" name="home" value="" autocomplete="off" />  </td>
                </tr>
                <tr>
                    <td> <label>tel</label>   </td>
                    <td>   <input type="tel" name="phone" value="" autocomplete="off" /> </td>
                </tr>
                <tr>
                    <td>  <label>Email cím</label>   </td>
                    <td>  <input type="email" name="mail" value="" autocomplete="none" />  </td>
                </tr>
                <tr>
                    <td>  <label>jelszó</label>  </td>
                    <td>  <input type="password" name="Upp" required /> </td>
                </tr>
                <tr>
                    <td>   <label>jelszó megerősítése</label>  </td>
                    <td>  <input type="password" name="UppR" required /> </td>
                </tr>
            </table>

            @*<br />
                 <br />
                  <br />
                 <br />
                <br />
                 <div class="col-md-6 mb-4 text-white" ">
                     <label>jelszó</label> <input type="password" name="Upp" required />
                 </div>
                 <div class="col-md-6 mb-4">
                     <div class="form-outline text-white" ">
                         <label>jelszó megerősítése</label> <input type="password" name="UppR" required />
                     </div>
                 </div>*@
            <input type="submit" name="no" value="regisztrál" />

        </form>

        @* this is for rents*@
        <form action="CreateRent" method="post" class="text-white bg-info bg-opacity-50">
            <h3 class="opacity-100">Kölcsönzés</h3>
            <label>Név</label>  <select name="id" onchange="myFunction()">
    @foreach (var item in cr)
    {
        user me = bullshit.user.FirstOrDefault(q => q.id == item.User_ID);

        if (me != null)
        {
            <option value="@item.User_ID">  @me.Username</option>
        }
    }

        </select><br />
            <label>könyv</label>  <select name="book_id">
                @foreach (var item2 in kv)
                {
                    <option value="@item2.Id">@item2.name @item2.Available_Quantity</option>
                }

            </select><br />
            <input type="submit" name="no" value="hozzáadás" />
        </form>

        <table class="table table-bordered text-light table-striped">
            <tr>
                <td>Név:</td>
                <td>@(Session["username"]) </td>
            </tr>
            <tr>
                <td>Kölcsönzések:</td>
            </tr>
            @if (rc == null)
            {
                <tr> jelenleg nincs Olvasokártya </tr>
            }
            <tr>
                <td>Könyv azonositó</td>
                <td>kölcsönzés ideje</td>
                <td>vissza adás határideje</td>
                <td>visszavitel ideje</td>
            </tr>
            @foreach (var item3 in rent)
            {
                <tr>
                    <td>@item3.Book_ID </td>
                    <td>@item3.Rent_Date </td>

                    <td>@item3.Due_Date </td>


                    @if (item3.Return_Date.ToString().Length > 2)
                    {
                        <td>@item3.Return_Date </td>
                    }
                    else
                    {
                        <td>@item3.Book_ID </td>
                    }
                </tr>
                @*<tr>
                <td>Bünti</td>
                <td>@item3.Punishment </td>
                @{puinishment += int.Parse(item3.Punishment.ToString());}
            </tr>*@
            }


        </table>
        <script>
            function myfunction() {
                console.log($("id").value);
                $.ajax({
                    url: "/Default/SetSession",
                    type: "POST",
                    data: { 'currentreadercard': $("id").value },
                    success: function () {
                    },
                    error: function () { alert("error"); }
                });
            }
        </script>

    </div>
</body>
</html>
